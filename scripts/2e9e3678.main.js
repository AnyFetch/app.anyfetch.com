"use strict";angular.module("anyfetchFrontApp").controller("MainCtrl",["$scope","$location","$http","$q","AuthService","DocumentTypesService","ProvidersService",function(a,b,c,d,e,f,g){a.search=function(a){b.search({q:a})},a.getSnippets=function(b){var e=d.defer(),h="http://api.anyfetch.com/documents?search="+b+"&limit=50";return c({method:"GET",url:h}).success(function(b){f.updateSearchCounts(b.document_types),g.updateSearchCounts(b.tokens),a.loading=!1,e.resolve(b)}).error(e.reject),e.promise},a.logout=function(){e.logout(function(){b.path("/login")})},a.isProviderUpToDate=function(a){var b=new Date;return a.updated>b-72e5},a.user=e.currentUser,a.query=b.search().q||"",a.results=[],a.documentTypes=f.documentTypes,a.providers=g.providers,a.query&&(a.loading=!0,a.getSnippets(a.query).then(function(b){a.results=b.datas}))}]);